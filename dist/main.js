!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=7)}([function(e,t){e.exports=require("rxjs/operators")},function(e,t){e.exports=require("rxjs")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("xlsx")},function(e,t){e.exports=require("exceljs")},function(e,t){e.exports=require("@pdftron/pdfnet-node")},function(e,t){e.exports=require("path")},function(e,t,o){"use strict";o.r(t),o.d(t,"useSecuredMethod",(function(){return M})),o.d(t,"hideZeroRow",(function(){return R})),o.d(t,"showAmountColumn",(function(){return k}));const n="dist/document/source",r="Tên thuốc, VTYT, hoá chất",i=e=>e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.toLowerCase()).replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a")).replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e")).replace(/ì|í|ị|ỉ|ĩ/g,"i")).replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o")).replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u")).replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y")).replace(/đ/g,"d")).replace(/\u0300|\u0301|\u0303|\u0309|\u0323/g,"")).replace(/\u02C6|\u0306|\u031B/g,""),s=e=>{const t=o(3),n=t.readFile(e),r=n.Sheets[n.SheetNames[0]];if(r)return t.utils.sheet_to_json(r)},l=async(e,t,n="Index",r,i=!0,s,l,a)=>{const u=new(o(4).Workbook),d=u.addWorksheet(n);let p;return l&&(p=u.addWorksheet(l)),t.unshift([""]),t.push([]),t.push([""]),d.addRows(t),s&&p&&(s.unshift([""]),s.push([]),s.push([""]),p.addRows(s)),c(d),h(d),p&&(c(p),h(p)),r&&r(d),a&&a(p),m(d.getCell("A"+d.rowCount)),p&&m(p.getCell("A"+p.rowCount)),await u.xlsx.writeFile(e)},c=(e,t="Tahoma",o=13)=>{for(let n=1;n<=e.columnCount;n++)e.getColumn(n).eachCell((e,n)=>{e.style={font:{name:t,size:o}}})},a=(e,t,o,n)=>{const r={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}};e.eachRow((i,s)=>{s>=t&&s<=o&&n.map(t=>{e.getCell(`${t}${s}`).border=r})})},u=(e,t,o,n=!0,r=!0)=>{const i=e.getCell(`${o}${t}`);i.style.font={name:"Tahoma",size:13,bold:!0},n&&(i.style.alignment={horizontal:"center",vertical:"middle"}),e.getRow(t).height=20,r&&(i.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFe1dbdb"}})},d=(e,t,o,n)=>{const r=e.getCell("A"+t);r.style.alignment={horizontal:"center",vertical:"middle"},r.style.font={name:"Tahoma",size:16,bold:!0},e.mergeCells(`${o}${t}:${n}${t}`),e.getRow(t).height=22},h=(e,t=16)=>{for(let o=1;o<=e.rowCount;o++)e.getRow(o).height=t,e.getRow(o).alignment={vertical:"middle"}},m=e=>{e.style.font={...e.style.font,italic:!0,color:{argb:"FF7b7979"}}};var p=o(1),g=o(0);const f=(e,t)=>{const n=o(2),r=i(t.pharmaceuticalRepresentatives.fullName);n.mkdirSync(b(),{recursive:!0});const s=[],c=[];s.push([""+t.pharmaceuticalRepresentatives.fullName]),s.push(["BẢNG TỔNG HỢP"]),s.push(k?[void 0,void 0,void 0,void 0,void 0,void 0,e[0]["Ngày"]]:[void 0,void 0,void 0,void 0,void 0,e[0]["Ngày"]]),c.push([""+t.pharmaceuticalRepresentatives.fullName]),c.push(["BẢNG CHI TIẾT"]),c.push([void 0,void 0,void 0,void 0,e[0]["Ngày"]]);const a=[],u=[];for(let o of t.data)for(let t of o.data){const n=S(e,j(o.doctor),t.TEN,t.MA);!n&&R||(a.push({name:`${t.TEN}(${t.CK})`,qty:n||0,price:t.GIA,discount:t.CK}),u.push({doctor:j(o.doctor),name:t.TEN,qty:n||0,price:t.GIA,discount:t.CK}))}u.sort((e,t)=>e.name>t.name?1:e.name<t.name?-1:0);const d=Object(p.from)(u).pipe(Object(g.groupBy)(e=>e.name),Object(g.mergeMap)(e=>Object(p.zip)(Object(p.of)(e.key),e.pipe(Object(g.reduce)((e,t)=>e+t.qty,0)),e.pipe(Object(g.toArray)()))));c.push(["STT","TÊN/BS",void 0,void 0,"SL"]);let h=0,m=0;d.subscribe(e=>{c.push([++m,e[0],void 0,void 0,e[1]]);const t=e[2];t.sort($);let o=0;for(let e of t){h+=e.qty;const{firstName:t,lastName:n}=A(e.doctor);c.push([void 0,++o,n,t,e.qty])}}),c.push(["TỔNG CỘNG",void 0,void 0,void 0,h]),a.sort((e,t)=>e.name>t.name?1:e.name<t.name?-1:0);const f=Object(p.from)(a).pipe(Object(g.groupBy)(e=>e.name),Object(g.mergeMap)(e=>e.pipe(Object(g.reduce)((e,t)=>(e.qty+=t.qty,e.price=t.price,e.discount=t.discount,e),{name:e.key,qty:0,price:void 0,discount:void 0}))),Object(g.toArray)());s.push(k?["STT","TÊN","SL","ĐƠN GIÁ","TT","%CK","CK"]:["STT","TÊN","SL","ĐƠN GIÁ","%CK","CK"]);let N=0,T=0,y=0;return f.subscribe(e=>{let t=0;for(let o of e){const e=o.qty*o.price,n=e*o.discount/100;N+=o.qty,T+=e,y+=n,s.push(k?[++t,F(o.name),o.qty,o.price,e,o.discount,n]:[++t,F(o.name),o.qty,o.price,o.discount,n])}}),s.push(k?["TỔNG",void 0,N,void 0,T,void 0,y]:["TỔNG",void 0,N,void 0,void 0,y]),l(`${b()}/${r}.xlsx`,s,"Tổng Hợp",v,!1,c,"Chi Tiết",C),[t.pharmaceuticalRepresentatives.fullName,N,T,y]},v=e=>{e.pageSetup.margins={left:.2,right:.2,top:.45,bottom:.45,header:.2,footer:.2},e.pageSetup.horizontalCentered=!0,k&&(e.pageSetup.orientation="landscape");const t=k?["A","B","C","D","E","F","G"]:["A","B","C","D","E","F"];d(e,3,t[0],t[t.length-1]),e.getCell(t[t.length-1]+"4").alignment={horizontal:"right",vertical:"middle"},t.map(t=>{u(e,5,t)}),t.map(t=>{u(e,e.rowCount-2,t,!1)}),e.mergeCells(`A${e.rowCount-2}:B${e.rowCount-2}`),e.getCell("A"+(e.rowCount-2)).style.alignment={horizontal:"center",vertical:"middle"},a(e,5,e.rowCount-2,t),["C","D","E","F","G"].map(t=>{e.getColumn(t).numFmt="#,##0"}),(k?[5,40,12,12,20,7,20]:[7,35,10,12,8,15]).map((t,o)=>{e.getColumn(o+1).width=t})},C=e=>{const t=["A","B","C","D","E"];d(e,3,t[0],t[t.length-1]),e.getCell(t[t.length-1]+"4").alignment={horizontal:"right",vertical:"middle"},t.map(t=>{u(e,5,t)}),e.eachRow((o,n)=>{if(o.values[1]&&n>5&&n<e.rowCount-2){e.mergeCells(`B${n}:D${n}`);for(let o=1;o<=t.length;o++){const r=e.getCell(`${t[o-1]}${n}`);r.style.font={...r.style.font,bold:!0}}}else 5===n?e.mergeCells(`B${n}:D${n}`):n===e.rowCount-2&&e.mergeCells(`A${n}:D${n}`)}),t.map(t=>{u(e,e.rowCount-2,t,!1)}),e.getCell("A"+(e.rowCount-2)).style.alignment={horizontal:"center",vertical:"middle"},a(e,5,e.rowCount-2,t),e.getColumn("E").numFmt="#,##0",[5,7,35,12,15].map((t,o)=>{e.getColumn(o+1).width=t})},N=(e,t)=>{const n=o(2),r=i(t.pharmaceuticalRepresentatives.fullName);n.mkdirSync(`${b()}/${r}`,{recursive:!0});const s=[];let c=0,a=0,u=0,d=0,h=!0;s.push([""+t.pharmaceuticalRepresentatives.fullName]),s.push(["BẢNG TÍNH TIỀN PHÍ"]);for(let o of t.data){const n=[];let m=0,p=0,g=0,f=0,v=0,C=0,N=!1;const T=[],w=[];for(let t of o.data){let n=S(e,j(o.doctor),t.TEN,t.MA);if(n||!R){void 0===n&&(n=0);const e=n*t.GIA,o=e*t.CK/100;let r,i;t.CKBS?(r=e*t.CKBS/100,i=o-r):h=!1,h?(T.push([++m,_(t.TEN),n,t.GIA,e,t.CK,o,t.CKBS,r,i]),w.push(k?[m,_(t.TEN,M),n,t.GIA,e,t.CKBS,r]:[m,_(t.TEN,M),n,t.GIA,t.CKBS,r])):T.push([++m,_(t.TEN),n,t.GIA,e,t.CK,o]),p+=n,g+=e,f+=o,c+=n,a+=e,u+=o,h&&(v+=r,d+=r,C+=i),N=!0}}N&&(s.push([]),h?s.push(["Bác Sĩ: "+(M?B(o.doctor):o.doctor),void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,e[0]["Ngày"]]):s.push(["Bác Sĩ: "+(M?B(o.doctor):o.doctor),void 0,void 0,void 0,void 0,void 0,e[0]["Ngày"]]),h?s.push(["STT","SP","SL","Đơn giá","Thành Tiền","% CK","CK","% CKBácS","CKBS","Còn lại"]):s.push(["STT","SP","SL","Đơn giá","Thành Tiền","% CK","CK"]),s.push(...T),h?s.push(["Tổng cộng",void 0,p,void 0,g,void 0,f,void 0,v,C]):s.push(["Tổng cộng",void 0,p,void 0,g,void 0,f]),h&&n.push(k?["STT","SP","SL","Đơn giá","Thành Tiền","% CK","CK"]:["STT","SP","SL","Đơn giá","% CK","CK"]),n.push(...w),h&&n.unshift([`${M?"Kính gửi khách hàng":"Kính gửi Bác Sĩ"}: ${M?B(o.doctor):j(o.doctor)}`]),n.unshift([e[0]["Ngày"]]),n.unshift([""+t.pharmaceuticalRepresentatives.fullName]),h&&n.push(k?["Tổng cộng",void 0,p,void 0,g,void 0,v]:["Tổng cộng",void 0,p,void 0,void 0,v]),l(`${b()}/${r}/${i(B(o.doctor))}_${G(o.doctor)}.xlsx`,n,"Index",y,!0))}h?s.push(["Tổng cộng tất cả",void 0,c,void 0,a,void 0,u,void 0,d,u-d]):s.push(["Tổng cộng tất cả",void 0,c,void 0,a,void 0,u]),l(`${b()}/${r}/index.xlsx`,s,"Index",e=>T(e,h))},T=(e,t)=>{e.pageSetup.margins={left:.2,right:.2,top:.45,bottom:.45,header:.2,footer:.2},e.pageSetup.horizontalCentered=!0,e.pageSetup.orientation="landscape";const o=t?["A","B","C","D","E","F","G","H","I","J"]:["A","B","C","D","E","F","G"];d(e,3,o[0],o[o.length-1]),e.eachRow((t,n)=>{t.values[1]&&(""+t.values[1]).startsWith("Bác Sĩ:")?e.getCell(`${o[o.length-1]}${n}`).alignment={horizontal:"right",vertical:"middle"}:"STT"===t.values[1]?o.map(t=>{u(e,n,t)}):"Tổng cộng"!==t.values[1]&&"Tổng cộng tất cả"!==t.values[1]||(o.map(t=>{u(e,n,t,!1)}),e.mergeCells(`A${n}:B${n}`),e.getCell("A"+n).style.alignment={horizontal:"center",vertical:"middle"})}),a(e,6,e.rowCount-2,o),["C","D","E","F","G","H","I","J"].map(t=>{e.getColumn(t).numFmt="#,##0"}),[5,15,10,10,18,7,17,7,17,15].map((t,o)=>{e.getColumn(o+1).width=t})},y=e=>{const t=k?["A","B","C","D","E","F","G"]:["A","B","C","D","E","F"];d(e,3,t[0],t[t.length-1]),e.getCell(t[t.length-1]+"4").alignment={horizontal:"right",vertical:"middle"},t.map(t=>{u(e,5,t)}),t.map(t=>{u(e,e.rowCount-2,t,!1)}),e.mergeCells(`A${e.rowCount-2}:B${e.rowCount-2}`),e.getCell("A"+(e.rowCount-2)).style.alignment={horizontal:"center",vertical:"middle"},a(e,5,e.rowCount-2,t),["C","D","E","F","G"].map(t=>{e.getColumn(t).numFmt="#,##0"}),(k?[5,18,10,10,18,7,17]:[5,23,12,13,10,20]).map((t,o)=>{e.getColumn(o+1).width=t})},S=(e,t,o,n)=>{const i=e.filter(e=>e["Họ - Tên Bsĩ"]===t&&(e["Mã hàng"]&&e["Mã hàng"].trim().length>0?e["Mã hàng"].trim().toLowerCase()===n.toLowerCase():e[r].toLowerCase().includes(o.toLowerCase())));return i&&i.length>0?i.map(e=>e.SL).reduce((e,t)=>e+t):void 0},b=()=>{const{month:e,year:t}=(()=>{const e=new Date,t=e.getFullYear();return{month:e.getMonth()+1,year:t}})();return`dist/document/dest/${t}/${e}`},w=(e,t,o)=>{const n=e.utils.decode_col(o),r=e.utils.decode_range(t["!ref"]);for(let o=r.s.r+1;o<=r.e.r;++o){const r=e.utils.encode_cell({r:o,c:n});t[r]&&("n"==t[r].t&&(t[r].z="#,##0"))}},B=e=>{const t=e.split("-");return t.length>1?t[0].trim():G(e)},j=e=>{const t=e.split("-");return t.length>1?t[1].trim():e},$=(e,t,o="doctor")=>{const{firstName:n,lastName:r}=x(e[o]),{firstName:i,lastName:s}=x(t[o]);return n>i?1:n<i?-1:r>s?1:r<s?-1:0},x=e=>{if(!e)return{lastName:void 0,firstName:void 0};const t=i(e),o=t.split(" ");if(o.length<2)return{lastName:void 0,firstName:t};const n=o[o.length-1].trim();o.splice(o.length-1,1);return{lastName:o.join(" ").trim(),firstName:n}},A=e=>{if(!e)return{lastName:void 0,firstName:void 0};const t=e.split(" ");if(t.length<2)return{lastName:void 0,firstName:e};const o=t[t.length-1].trim();t.splice(t.length-1,1);return{lastName:t.join(" ").trim(),firstName:o}},O=e=>{const t=["A","B","C","D","E"];d(e,3,t[0],t[t.length-1]),e.getCell("E4").alignment={horizontal:"right",vertical:"middle"},t.map(t=>{u(e,5,t)}),t.map(t=>{u(e,e.rowCount-2,t,!1)}),e.mergeCells(`A${e.rowCount-2}:D${e.rowCount-2}`),e.getCell("A"+(e.rowCount-2)).style.alignment={horizontal:"center",vertical:"middle"},a(e,5,e.rowCount-2,t),e.getColumn("E").numFmt="#,##0",[5,30,25,11,12].map((t,o)=>{e.getColumn(o+1).width=t})},_=(e,t=!1)=>{const o=(e=e.replace("/","-")).replace(/\(.*?\)/,"").trim();return t?o.substring(0,4)+"*".repeat(o.length-4):o},G=e=>{const t=e.split("-");let o;o=t.length>1?t[1]:e;const n=o.split(" "),r=[];for(let e of n)r.push(e[0]);return r.join("").toLowerCase()},K=(e,t,n)=>{const r=o(2),s=i(n.fullName);r.mkdirSync(b(),{recursive:!0});const c=[],a=[];c.push([""+n.fullName]),c.push(["BẢNG TỔNG HỢP"]),c.push(k?[void 0,void 0,void 0,void 0,void 0,void 0,e[0]["Ngày"]]:[void 0,void 0,void 0,void 0,void 0,e[0]["Ngày"]]),a.push([""+n.fullName]),a.push(["BẢNG CHI TIẾT"]),a.push([void 0,void 0,void 0,void 0,e[0]["Ngày"]]);const u=[],d=[];for(let o of t)for(let t of o.doctors){let n=S(e,t.DoctorName,o.ProductName,o.ProductId);!n&&R||(void 0===n&&(n=0),u.push({name:o.ProductName,qty:null!=n?n:0,price:o.Price,discount:o.Discount}),d.push({doctor:t.DoctorName,name:o.ProductName,qty:null!=n?n:0,price:o.Price,discount:o.Discount}))}d.sort((e,t)=>e.name>t.name?1:e.name<t.name?-1:0);const h=Object(p.from)(d).pipe(Object(g.groupBy)(e=>e.name),Object(g.mergeMap)(e=>Object(p.zip)(Object(p.of)(e.key),e.pipe(Object(g.reduce)((e,t)=>e+t.qty,0)),e.pipe(Object(g.toArray)()))));a.push(["STT","TÊN/BS",void 0,void 0,"SL"]);let m=0,f=0;h.subscribe(e=>{a.push([++f,e[0],void 0,void 0,e[1]]);const t=e[2];t.sort($);let o=0;for(let e of t){m+=e.qty;const{firstName:t,lastName:n}=A(e.doctor);a.push([void 0,++o,n,t,e.qty])}}),a.push(["TỔNG CỘNG",void 0,void 0,void 0,m]),u.sort((e,t)=>e.name>t.name?1:e.name<t.name?-1:0);const N=Object(p.from)(u).pipe(Object(g.groupBy)(e=>e.name),Object(g.mergeMap)(e=>e.pipe(Object(g.reduce)((e,t)=>(e.qty+=t.qty,e.price=t.price,e.discount=t.discount,e),{name:e.key,qty:0,price:void 0,discount:void 0}))),Object(g.toArray)());c.push(k?["STT","TÊN","SL","ĐƠN GIÁ","TT","CK","TCK"]:["STT","TÊN","SL","ĐƠN GIÁ","CK","TCK"]);let T=0,y=0,w=0;return N.subscribe(e=>{let t=0;for(let o of e){const e=o.qty*o.price,n=e*o.discount/100;T+=o.qty,y+=e,w+=n,c.push(k?[++t,o.name,o.qty,o.price,e,o.discount,n]:[++t,o.name,o.qty,o.price,o.discount,n])}}),c.push(k?["TỔNG",void 0,T,void 0,y,void 0,w]:["TỔNG",void 0,T,void 0,void 0,w]),l(`${b()}/${s}.xlsx`,c,"Tổng Hợp",v,!1,a,"Chi Tiết",C),[n.fullName,T,y,w]},D=e=>{const t=["A","B","C","D","E","F"];d(e,3,t[0],t[t.length-1]),e.getCell("F4").alignment={horizontal:"right",vertical:"middle"},t.map(t=>{u(e,5,t)}),t.map(t=>{u(e,e.rowCount-2,t,!1)}),e.mergeCells(`A${e.rowCount-2}:B${e.rowCount-2}`),e.getCell("A"+(e.rowCount-2)).style.alignment={horizontal:"center",vertical:"middle"};for(let t=6;t<e.rowCount;t++)e.getCell("D"+t).font={color:{argb:"FFAAAAAA"},italic:!0};a(e,5,e.rowCount-2,t),["C","D","E"].map(t=>{e.getColumn(t).numFmt="#,##0"}),[5,13,12,20,20,10].map((t,o)=>{e.getColumn(o+1).width=t})},F=e=>e.replace(/\([0-9]{1,2}\)/,"").trim(),I=e=>{e.unshift(["Mã Bác Sĩ","Bác Sĩ","SL","Tổng Doanh Số Bán Lẻ","Hạng"]);let t=0;e=e.map(e=>(e[1]&&e.push(t++),e));const n=o(3),r=n.utils.book_new();r.Props={Title:"LamGift",Author:"Ly Van Khai 0986 409 026",Subject:"Excel Generator"},r.SheetNames.push("Index");const i=n.utils.aoa_to_sheet(e);w(n,i,"C"),w(n,i,"D");i["!cols"]=[{wch:7},{wch:30},{wch:12},{wch:20},{wch:5}];const s=[];s.push({s:{r:e.length-1,c:0},e:{r:e.length-1,c:1}}),i["!merges"]=s,r.Sheets.Index=i;o(2).mkdirSync(b()+"/doctors",{recursive:!0}),n.writeFile(r,b()+"/doctors/_summary.xlsx")},L=(e,t)=>{t.unshift(["Thuốc","SL","Thành Tiền Bán Lẻ"]);const n=o(3),r=n.utils.book_new();r.Props={Title:"LamGift",Author:"Ly Van Khai 0986 409 026",Subject:"Excel Generator"},r.SheetNames.push("Index");const i=n.utils.aoa_to_sheet(t);w(n,i,"B"),w(n,i,"C");i["!cols"]=[{wch:40},{wch:7},{wch:15}],r.Sheets.Index=i;o(2).mkdirSync(b()+"/doctors",{recursive:!0}),n.writeFile(r,`${b()}/doctors/${e}.xlsx`)},q=(e,t)=>{const{firstName:o,lastName:n}=x(e["Họ - Tên Bsĩ"]),{firstName:i,lastName:s}=x(t["Họ - Tên Bsĩ"]);return o>i?1:o<i?-1:n>s?1:n<s?-1:e[r]>t[r]?1:e[r]<t[r]?-1:0},P=(e,t)=>{const o=e.find(e=>e.FullName===t);return o&&o.ID?""+o.ID:G(t)},E=e=>{const t=o(3),n=t.readFile(e);if(0===n.SheetNames.length)return;const r=[];let i;for(let e in n.Sheets)if("Info"!==e){const o=t.utils.sheet_to_json(n.Sheets[e]);r.push({doctor:e,data:o})}else{const o=t.utils.sheet_to_json(n.Sheets[e]);o&&o.length>0&&(i={fullName:o[0].FullName,phoneNumber:o[0].PhoneNumber,email:o[0].Email})}return{pharmaceuticalRepresentatives:i,data:r}},z=e=>{const t=o(3),n=t.readFile(e);if(0===n.SheetNames.length)return;let r;const i=t.utils.sheet_to_json(n.Sheets.Info);return i&&i.length>0&&(r={fullName:i[0].FullName,phoneNumber:i[0].PhoneNumber,email:i[0].Email}),{pharmaceuticalRepresentatives:r,data:t.utils.sheet_to_json(n.Sheets.Index)}},{PDFNet:H}=o(5),M=(o(6),"1"===process.argv[2]),R="1"===process.argv[3],k="1"===process.argv[4];new Promise((e,t)=>{const i=o(2);i.readdir(n,(c,a)=>{const u=a.filter(e=>".DS_Store"!==e&&!e.startsWith("~")),d=u.length;if(0===d)t({message:"Ban chua copy file goc vao thu muc: "+n,result:!1});else if(d>1)t({message:"Co qua nhieu file trong thu muc: "+n,result:!1});else{const t=s(`${n}/${u[0]}`);(e=>{const t="Tên thuốc",n=o(2);let i;n.mkdirSync(b()+"/products",{recursive:!0}),n.readdir("dist/document/price_list",(o,n)=>{const c=n.filter(e=>".DS_Store"!==e&&!e.startsWith("~")),a=c.length;if(0!==a)if(a>1)console.log("Co qua nhieu file danh muc hang hoa trong thu muc document -> price_list");else{i=s("dist/document/price_list/"+c[0]);for(let o of i){const n=e.filter(e=>!(!e["Mã hàng"]||!o["Mã thuốc"]||e["Mã hàng"].trim().toLowerCase()!==o["Mã thuốc"].trim().toLowerCase())||!!(e[r]&&o[t]&&e[r].includes(o[t])));if(n&&n.length>0){n.sort((e,t)=>$(e,t,"Họ - Tên Bsĩ"));const r=[];let i=0,s=0;for(let e of n){const{lastName:t,firstName:o}=A(e["Họ - Tên Bsĩ"]);i+=e.SL,r.push([++s,e["Ngày"],t,o,e.SL])}r.unshift(["STT","Ngày","Họ lót BS","Tên BS","SL"]),r.unshift([void 0,void 0,void 0,void 0,e[0]["Ngày"]]),r.unshift(["BÁO CÁO TÌNH HÌNH MUA BÁN THUỐC "+_(o[t]).toUpperCase()]),r.unshift([]),r.push(["Tổng cộng",void 0,void 0,void 0,i]),l(`${b()}/products/${_(o[t])}.xlsx`,r,"Index",O)}}}else console.log("Khong tim thay file danh muc hang hoa trong thu muc document -> price_list")})})(t),(e=>{o(2).readdir("dist/document/doctor",(t,o)=>{const n=o.filter(e=>".DS_Store"!==e&&!e.startsWith("~"));if(n.length>0){const t=s("dist/document/doctor/"+n[0]);e.sort(q);const o=Object(p.from)(e).pipe(Object(g.filter)(e=>e["Ngày"]),Object(g.groupBy)(e=>e["Họ - Tên Bsĩ"]),Object(g.mergeMap)(e=>Object(p.zip)(Object(p.of)(e.key),e.pipe(Object(g.reduce)((e,t)=>e+t.SL,0)),e.pipe(Object(g.reduce)((e,t)=>e+t["Thành tiền"],0)),e.pipe(Object(g.toArray)())))),i=[];let l=0,c=0;o.subscribe(e=>{if(l+=e[1],c+=e[2],e[0]){const o=P(t,e[0]);i.push([o,e[0],e[1],e[2]]);const n=[];e[3].sort((e,t)=>e[r]>t[r]?1:e[r]<t[r]?-1:0);let s=0,l=0;for(let t of e[3])n.push([t[r],t.SL,t["Thành tiền"]]),s+=t.SL,l+=t["Thành tiền"];n.push(["Tổng cộng",s,l]),L(o,n)}else i.push(["Bán lẻ",void 0,e[1],e[2]])}),i.sort((e,t)=>e[3]>t[3]?-1:e[3]<t[3]?1:0),i.push(["Tổng cộng",void 0,l,c]),I(i)}else console.log("Không tìm thấy file danh mục bác sĩ trong thu mục dist -> doctor")})})(t),i.readdir("dist/document/doctor_product",(n,r)=>{const s=r.filter(e=>".DS_Store"!==e&&!e.startsWith("~")),c=(s.length,[]);for(let e of s){const o=E("dist/document/doctor_product/"+e);N(t,o);const n=f(t,o);c.push(n)}i.readdir("dist/document/product_doctor",(e,n)=>{const r=n.filter(e=>".DS_Store"!==e&&!e.startsWith("~"));r.length;for(let e of r){const o=z("dist/document/product_doctor/"+e),n=[];let r;for(let e of o.data)e.ProductId||e.ProductName?(r=e,n.push(r)):(r.doctors||(r.doctors=[]),r.doctors.push(e));n.sort((e,t)=>e.ProductName>t.ProductName?1:e.ProductName<t.ProductName?-1:0);const i=K(t,n,o.pharmaceuticalRepresentatives);c.push(i)}c.sort((e,t)=>e[0]>t[0]?1:e[0]<t[0]?-1:0),((e,t)=>{let n=1,r=0,i=0,s=0;(t=t.map(e=>(r+=e[1],i+=e[2],s+=e[3],e.unshift(n++),e))).unshift(["STT","TD","SL","Doanh Số","CK","Ghi Chú"]),t.unshift([void 0,void 0,void 0,void 0,void 0,""+e]),t.unshift(["BẢNG TỔNG HỢP"]),t.unshift([]),t.push(["Tổng Cộng",void 0,r,i,s]),o(2).mkdirSync(""+b(),{recursive:!0}),l(b()+"/_summary.xlsx",t,"Index",D)})(t[0]["Ngày"],c)}),e({result:!0,message:"Success"})})}})}).then(e=>{e.result&&console.log(e.message)}).catch(e=>{console.log(e.message)})}]);